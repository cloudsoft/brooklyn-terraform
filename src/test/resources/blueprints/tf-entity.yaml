name: tf-container-entity
services:
  - type: 'terraform-entity:1.1.0-SNAPSHOT'
    brooklyn.config:
      # Fetching archives over HTTP
      tf.configuration.url: 'https://artifactory.cloudsoftcorp.com/artifactory/libs-release-local/io/cloudsoft/packs/instance-with-creds.tf'
      
      # replace with aws credential values
      shell.env:
        TF_VAR_aws_identity: $brooklyn:external("vault", "aws_identity")  # use these as env in the effector
        TF_VAR_aws_credential: $brooklyn:external("vault", "aws_credential")  # use these as env in the effector
    brooklyn.initializers:
      - type: io.cloudsoft.terraform.TerraformEffector
        brooklyn.config:
          devMode: true
          containerImage: docker pull hashicorp/terraform
          activityName: Terraform Init Workspace
          commands:
            - init -input=false
          name: init-effector
